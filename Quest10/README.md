# Quest 10. 인증의 이해

## Introduction
* 이번 퀘스트에서는 웹에서의 인증에 관해 알아보겠습니다.

## Topics
* Cookie
* Session
* JWT

## Resources
* [MDN - HTTP 쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)
* [Cookies and Sessions](https://web.stanford.edu/~ouster/cgi-bin/cs142-fall10/lecture.php?topic=cookie)
* [JWT](https://jwt.io/)

## Checklist
* 쿠키란 무엇일까요?
  # 보완
  ```
  HTTP 쿠키(웹 쿠키, 브라우저 쿠키)는 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각입니다.
  => httponly 쿠키
  ```
  > - 클라이언트 로컬에 저장이되는 key-value쌍의 작은 데이터 파일입니다.
  > - 서버에 요청시 쿠키에 저장된 데이터를 함께 보낼수가 있습니다.
  > - httpOnly쿠키는 서버에서 사용자의 웹브라우저에 전송하는 데이터 조각이며, 클라이언트 스크립트에선 접근불가함
  * 쿠키는 어떤 식으로 동작하나요?
  * 쿠키는 어떤 식으로 서버와 클라이언트 사이에 정보를 주고받나요?
    > - 서버가 클라이언트 요청에 응답을할때 쿠키를 생성하여서 응답헤더에 set-cookie에 데이터를 담아서 응답합니다.
    > `Set-Cookie: <cookie-name>=<cookie-value>`
    > - 클라이언트는 전달받은 쿠키를 가지게 되고, 서버에 요청할때마다 자동으로 쿠키가 담아져서 요청이 가게 됩니다.
    > - 저장된 쿠키는 만료되기 전까지 사용할 수 있습니다.
* 웹 어플리케이션의 세션이란 무엇일까요?
  > - 추상적인 개념...
  > - 세션이란 일정시간 동안 같은 사용자로 부터 들어오는 일련의 요구를 하나의상태로보고 그상태를 유지시키는 기술을 이야기합니다.
  > - 사용자가 브라우저를 닫고 서버와의 연결을 끝내는 시점까지를 세션이라고 합니다.
  * 세션의 ID와 내용은 각각 어디에 저장되고 어떻게 서버와 교환되나요?
    > - 세션의 id는 클라이언트 쿠키에 저장이 되고, 내용은 서버에 저장이됩니다.
    > - 서버에서 요청이 들어오면 쿠키에있는 세션id로 세션에서 정보를 가져와 유저를 식별합니다.
    > - 세션의 사용자 정보를 저장하는 공간은 서버에서 선택할 수가 있는데 데이터베이스나, 서버 메모리에 보관합니다.
* JWT란 무엇인가요?
  > - Json Web Token의 약자로 웹 상에서 정보를 Json형태로 주고 받기 위해 표준규약에 따라 생성화된암호화된 토큰입니다. 복잡하고 읽을 수 없는 string 형태로 저장이 되어집니다.
  * JWT 토큰은 어디에 저장되고 어떻게 서버와 교환되나요?
    > - 저장하는 장소로는 클라이언트에서 정하며, 웹 스토리지 또는 쿠키에 저장할 수 있습니다.
    > - 웹스토리지 같은 경우는 스크립트 접근이 가능하여 XSS공격에 취약한 반면 쿠키는 이런 문제를 해결할수 있지만 단일 도메인 및 서브도메인에만 작동하도록 설계되어있기 때문에 여러 도메인에서 관리하기가 힘듭니다.
    > - 서버와의 교환과정
    >   1. 클라이언트가 서버에 요청을하면 서버는 시크릿키로 JWT를 생성하여 쿠키에 담아서 클라이언트에게 발급합니다.
    >   2. 클라이언트는 JWT를 스토리지나, 쿠키에 저장하여서 API 요청시 Authorization header에 토큰을 담아서 보냅니다.
    >   3. 서버에서는 확인할때 서버에서 발행된 토큰인지 확인하고, 페이로드에 있는 정보를 활용하여 데이터를 가져와 응답합니다.

* 세션에 비해 JWT가 가지는 장점은 무엇인가요? 또 JWT에 비해 세션이 가지는 장점은 무엇인가요?
  > * 세션과 JWT토큰을 사용하는방법의 가장 큰 차이는 사용자의 정보가 저장되는 위치입니다.
  > - 세션은 사용자의 정보를 서버에서 관리하므로, 보안면에서 우수하지만 세션이 늘어나면 서버에 부하가 생깁니다.
  > - JWT토큰은 토큰안에 사용자 정보가 있으므로, 서버는 무상태가 되어 서버 확장성이 우수해질수가 있고, 쿠키가 없는 모바일에서도 토큰을 이용하여 인증방식을 진행할수 있습니다. 단점은 토큰이 탈취 당할 우려가 있어서 보안상의 위험이 있습니다.
## Quest
* 이번에는 메모장 시스템에 로그인 기능을 넣고자 합니다.
  * 사용자는 딱 세 명만 존재한다고 가정하고, 아이디와 비밀번호, 사용자의 닉네임은 하드코딩해도 무방합니다.
  * 로그인했을 때 해당 사용자가 이전에 작업했던 탭들과 마지막으로 활성화된 탭 등의 상태가 로딩 되어야 합니다.
  * 세션을 이용한 버전과, JWT를 이용한 버전 두 가지를 만들어 보세요!
    * 세션을 이용할 경우 세션은 서버의 메모리나 파일에 저장하면 됩니다.

## Advanced
* Web Authentication API(WebAuthn)은 무엇인가요?
  > - 2019년 3월 4일에 웹표준 기술이 되었으며, 아이디 / 비밀번호 인증절차가 아닌 Public Key 기반의 웹인증을 이야기합니다.
  > - 여기에는 FIDO2라는 인증기술이 있으며, 내장인증(지문인식, 얼굴인식, 모바일 핀번호), 외부인증(전용인증어플, 하드웨어 보안키)이 있습니다.
